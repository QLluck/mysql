### 实验过程
本次实验基于学生-课程数据库，通过`INSERT`、`UPDATE`、`DELETE`语句完成数据插入、修改和删除操作，同时结合条件筛选、聚合函数和子查询实现复杂更新需求，掌握SQL数据更新的核心语法和应用场景。

### 实验详细操作步骤或程序清单
```sql
USE School;

-- （1）插入学生记录（学号：08030，姓名：李莉，年龄：18）
INSERT INTO student (sno, sname, sage, ssex, sdept) 
VALUES ('08030', '李莉', 18, '女', ''); -- 系别留空，可根据需求补充

-- （2）插入选课记录（08030，1）
INSERT INTO sc (sno, cno, Grade) 
VALUES ('08030', '001', NULL); -- 成绩暂空，或根据需求设置

-- （3）计算机系学生年龄改成20
UPDATE student 
SET sage = 20 
WHERE sdept = 'cs';

-- （4）数学系所有学生成绩改成0
UPDATE sc 
SET Grade = 0 
WHERE sno IN (SELECT sno FROM student WHERE sdept = 'ma');

-- （5）把低于总平均成绩的女同学成绩提高5分
UPDATE sc 
SET Grade = Grade + 5 
WHERE sno IN (SELECT sno FROM student WHERE ssex = '女') 
AND Grade < (SELECT AVG(Grade) FROM sc WHERE Grade IS NOT NULL);

-- （6）修改2号课程的成绩，按条件调整（MySQL用IF函数）
UPDATE sc 
SET Grade = IF(Grade < 75, Grade * 1.05, Grade * 1.04) 
WHERE cno = '002';

-- （7）删除08030学生信息（先删选课记录，避免外键约束）
DELETE FROM sc WHERE sno = '08030';
DELETE FROM student WHERE sno = '08030';

-- （8）删除SC表中无成绩的记录
DELETE FROM sc WHERE Grade IS NULL;

-- （9）删除张娜的选课记录（假设姓名为“张那”）
DELETE FROM sc 
WHERE sno = (SELECT sno FROM student WHERE sname = '张那');

-- （10）删除数学系所有学生选课记录
DELETE FROM sc 
WHERE sno IN (SELECT sno FROM student WHERE sdept = 'ma');

-- （11）删除不及格的学生选课记录
DELETE FROM sc WHERE Grade < 60;

-- （12）查询每门课成绩≥80的学生，插入STU表（先创建STU表）
CREATE TABLE IF NOT EXISTS STU (SNO CHAR(8), SNAME VARCHAR(8), SSEX CHAR(2));
INSERT INTO STU (SNO, SNAME, SSEX)
SELECT s.sno, s.sname, s.ssex
FROM student s
WHERE NOT EXISTS (
    SELECT * FROM sc 
    WHERE sc.sno = s.sno AND (Grade < 80 OR Grade IS NULL)
);

-- （13）统计3门以上不及格的学生，追加到新表（先创建新表）
CREATE TABLE IF NOT EXISTS Failed_Students (SNAME VARCHAR(8), SDEPT VARCHAR(20));
INSERT INTO Failed_Students (SNAME, SDEPT)
SELECT s.sname, s.sdept
FROM student s
JOIN sc ON s.sno = sc.sno
WHERE sc.Grade < 60
GROUP BY s.sno, s.sname, s.sdept
HAVING COUNT(sc.cno) > 3;
```

### 疑难小结
1. **外键约束导致删除失败**：删除学生记录时，直接删除`student`表会因`sc`表外键关联报错，需先删除`sc`表中的相关选课记录，再删除学生记录。
2. **NULL值影响聚合计算**：计算总平均成绩时，需排除`Grade IS NULL`的记录，否则`AVG(Grade)`会忽略NULL值，但条件筛选时需明确处理。
3. **条件更新函数使用**：MySQL中用`IF()`函数实现条件更新，需注意函数语法（`IF(条件, 结果1, 结果2)`），避免与其他数据库的`CASE WHEN`混淆。
4. **子查询关联条件**：查询每门课成绩≥80的学生时，需用`NOT EXISTS`确保无不及格记录，而非简单的`Grade ≥ 80`，避免遗漏未选课学生。

### 实验结果
1. 所有`INSERT`、`UPDATE`、`DELETE`语句均可正确执行，数据更新符合需求。
2. 掌握了带条件的更新操作（如按系别修改年龄、按成绩比例调整），以及关联子查询在更新/删除中的应用。
3. 学会了将查询结果插入新表的方法，实现数据的筛选和迁移，满足复杂业务需求。